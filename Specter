-- Load GUI library
local SpecterGui = loadstring(game:HttpGet("https://raw.githubusercontent.com/DashaBars/Hack/main/Gui"))()
local SpecterWindow = SpecterGui:Window("Specter")
local SpiritBoxWindow = SpecterGui:Window("Spirit box")

-- Services and variables
local CoreGui = game:GetService("CoreGui")
local Workspace = game:GetService("Workspace")
local Lighting = game:GetService("Lighting")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local HumanoidRootPart = LocalPlayer.Character.HumanoidRootPart

-- Protect GUI function (if Synapse is not used)
if not pcall(function() return syn.protect_gui end) then
    syn = {}
    syn.protect_gui = function(guiElement)
        guiElement.Parent = CoreGui
    end
end

-- Adjust game settings
Workspace.FallenPartsDestroyHeight = -50000
Lighting.Brightness = 2
Lighting.GlobalShadows = false
Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
Lighting.Ambient = Color3.fromRGB(128, 128, 128)
Lighting.FogEnd = 100000

-- Remove Atmosphere objects from Lighting
for _, atmosphere in pairs(Lighting:GetDescendants()) do
    if atmosphere:IsA("Atmosphere") then
        atmosphere:Destroy()
    end
end

-- Function to create BillboardGui for various elements
local function createBillboardGui(parent, text, color)
    local billboard = Instance.new("BillboardGui")
    billboard.Adornee = parent
    billboard.Parent = parent
    billboard.Size = UDim2.new(0, 100, 0, 150)
    billboard.StudsOffset = Vector3.new(0, 1, 0)
    billboard.AlwaysOnTop = true

    local textLabel = Instance.new("TextLabel")
    textLabel.Parent = billboard
    textLabel.BackgroundTransparency = 1
    textLabel.Position = UDim2.new(0, 0, 0, -50)
    textLabel.Size = UDim2.new(0, 100, 0, 100)
    textLabel.Font = Enum.Font.SourceSansSemibold
    textLabel.TextSize = 14
    textLabel.TextColor3 = color
    textLabel.TextStrokeTransparency = 0
    textLabel.TextYAlignment = Enum.TextYAlignment.Bottom
    textLabel.Text = text
    textLabel.ZIndex = 10

    local function updatePosition()
        local connection
        connection = game:GetService("RunService").RenderStepped:Connect(function()
            if parent and parent.Parent and textLabel.Parent then
                local position, onScreen = Workspace.CurrentCamera:WorldToViewportPoint(parent.Position)
                if onScreen then
                    textLabel.Position = Vector2.new(position.X, position.Y)
                    textLabel.Visible = true
                else
                    textLabel.Visible = false
                end
            else
                textLabel.Visible = false
                if connection then
                    connection:Disconnect()
                end
            end
        end)
    end

    coroutine.wrap(updatePosition)()
end

-- Function to create BillboardGui for specific elements
local function createSpecificBillboardGui(parent, name, color)
    for _, child in pairs(parent:GetChildren()) do
        if child.Name == name then
            createBillboardGui(child, name, color)
        end
    end

    parent.ChildAdded:Connect(function(child)
        if child.Name == name then
            createBillboardGui(child, name, color)
        end
    end)
end

-- Create BillboardGui for existing orbs
for _, orb in pairs(Workspace:GetChildren()) do
    if orb.Name == "Orb" then
        createSpecificBillboardGui(orb, "Orb", Color3.fromRGB(30, 144, 255))
    end
end

-- Create BillboardGui for EMF parts
createSpecificBillboardGui(Workspace, "emfpart5", Color3.fromRGB(255, 0, 0))
createSpecificBillboardGui(Workspace, "emfpart3", Color3.fromRGB(255, 140, 0))
createSpecificBillboardGui(Workspace, "emfpart4", Color3.fromRGB(255, 69, 0))

-- Create BillboardGui for GhostModel
for _, ghost in pairs(Workspace:GetChildren()) do
    if ghost.Name == "GhostModel" and ghost:FindFirstChild("Humanoid") then
        local ghostName = workspace.Van.Objectives.SurfaceGui.Frame.Objectives.GhostInfo.Text:split("is ")[2]:match(">(.+)<")
        createBillboardGui(ghost.HumanoidRootPart, "Ghost Name: " .. ghostName, Color3.new(1, 1, 1))
    end
end

-- Create BillboardGui for FuseBox
createSpecificBillboardGui(Workspace.House, "FuseBox", Color3.fromRGB(192, 192, 192))

-- Create BillboardGui for Van Spawn
createSpecificBillboardGui(Workspace.Van, "Spawn", Color3.fromRGB(255, 0, 255))

-- Create BillboardGui for Bone
createSpecificBillboardGui(Workspace.House, "Bone", Color3.fromRGB(230, 230, 250))

-- Create BillboardGui for Exit (Doors)
for _, door in pairs(Workspace.House.Outside.Doors:GetChildren()) do
    if door.Name == "Door" and door:FindFirstChild("Door") then
        createBillboardGui(door, "Exit", Color3.fromRGB(0, 128, 0))
    end
end

-- Specter window buttons
SpecterWindow:Button("Sanity check", function()
    local sanity = LocalPlayer.Data:FindFirstChild("Sanity")
    if sanity then
        game:GetService("StarterGui"):SetCore("ChatMakeSystemMessage", {
            Text = "Sanity: " .. tostring(math.floor(sanity.Value)),
            Color = Color3.fromRGB(70, 130, 180),
            Font = Enum.Font.SourceSansBold,
            FontSize = Enum.FontSize.Size24
        })
    end
end)

SpecterWindow:Button("Not Alone", function()
    LocalPlayer.Data.Alone.Value = false
end)

SpecterWindow:Button("Alone", function()
    LocalPlayer.Data.Alone.Value = true
end)

SpecterWindow:Button("TpToGhostRoom", function()
    HumanoidRootPart.CFrame = Workspace.emfpart2.CFrame
end)

SpecterWindow:Button("TpToFuse", function()
    HumanoidRootPart.CFrame = Workspace.House.FuseBox.CFrame
end)

SpecterWindow:Button("TpToBone", function()
    HumanoidRootPart.CFrame = Workspace.House.Bone.CFrame + Vector3.new(0, 2, 0)
end)

SpecterWindow:Button("TpToVan", function()
    HumanoidRootPart.CFrame = Workspace.Van.Spawn.CFrame + Vector3.new(0, 3, 0)
end)

-- Spirit box window buttons
SpiritBoxWindow:Button("All words", function()
    local words = {
        "Hello? Anyone here? Someone there? How old are you? Where are you? Are you here?",
        "Are you old? Are you a man? Are you a woman? Show us a sign, Give us a sign, Are you there?"
    }
    game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(unpack(words))
end)

SpiritBoxWindow:Button("Hello?", function()
    game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Hello?", "All")
end)

SpiritBoxWindow:Button("Someone there?", function()
    game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Someone there?", "All")
end)

SpiritBoxWindow:Button("Anyone here?", function()
    game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Anyone here?", "All")
end)

SpiritBoxWindow:Button("How old?", function()
    game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("How old are you?", "All")
end)

SpiritBoxWindow:Button("Where are you?", function()
    game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Where are you?", "All")
end)

SpiritBoxWindow:Button("Are you here?", function()
    game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Are you here?", "All")
end)

SpiritBoxWindow:Button("Show us a sign", function()
    game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Show us a sign", "All")
end)

SpiritBoxWindow:Button("Give us a sign", function()
    game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Give us a sign", "All")
end)

SpiritBoxWindow:Button("Are you there?", function()
    game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer("Are you there?", "All")
end)
